<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.67.0" />

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">



<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Code Generation and Extraction | CUE</title><meta property="og:title" content="Code Generation and Extraction" />
<meta property="og:description" content="Converting CUE constraints to and from definitions in other languages." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cuelang.org/docs/usecases/generate/" />
<meta property="article:modified_time" content="2019-09-01T05:31:33+02:00" /><meta property="og:site_name" content="CUE" />
<meta itemprop="name" content="Code Generation and Extraction">
<meta itemprop="description" content="Converting CUE constraints to and from definitions in other languages.">
<meta itemprop="dateModified" content="2019-09-01T05:31:33&#43;02:00" />
<meta itemprop="wordCount" content="514">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Code Generation and Extraction"/>
<meta name="twitter:description" content="Converting CUE constraints to and from definitions in other languages."/>





<link rel="preload" href="/scss/main.min.f56d687752891909019b7a425ae3aefe3e6508a54e92b7a1dc91a12c9a948211.css" as="style">
<link href="/scss/main.min.f56d687752891909019b7a425ae3aefe3e6508a54e92b7a1dc91a12c9a948211.css" rel="stylesheet" integrity="">


<link rel="stylesheet" type="text/css" href=https://cuelang.org/css/asciinema-player.css />
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>

    <title>Code Generation and Extraction | CUE</title>
  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="text-uppercase font-weight-bold">CUE</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/docs/" ><span>Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/community/" ><span>Community</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="https://github.com/cuelang/cue" target="_blank" ><span>GitHub</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="off">

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a>
  </li>
  <ul>
    <li class="collapse show" id="docs">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/about/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">About</a>
  </li>
  <ul>
    <li class="collapse " id="docsabout">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/install/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Getting Started</a>
  </li>
  <ul>
    <li class="collapse " id="docsinstall">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/usecases/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Use Cases</a>
  </li>
  <ul>
    <li class="collapse show" id="docsusecases">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsusecasesconfiguration" href="/docs/usecases/configuration/">Configuration</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsusecasesvalidation" href="/docs/usecases/validation/">Data Validation</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsusecasesdatadef" href="/docs/usecases/datadef/">Schema Definition</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page  active" id="m-docsusecasesgenerate" href="/docs/usecases/generate/">Code Generation and Extraction</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsusecasesquery" href="/docs/usecases/query/">Querying</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsusecasesscripting" href="/docs/usecases/scripting/">Scripting</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/integrations/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Integrations</a>
  </li>
  <ul>
    <li class="collapse " id="docsintegrations">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsintegrationsjson" href="/docs/integrations/json/">JSON</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsintegrationsyaml" href="/docs/integrations/yaml/">YAML</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsintegrationsgo" href="/docs/integrations/go/">Go</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsintegrationsprotobuf" href="/docs/integrations/protobuf/">Protobuf</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsintegrationsopenapi" href="/docs/integrations/openapi/">OpenAPI and CRDs</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsintegrationsk8s" href="/docs/integrations/k8s/">Kubernetes</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/concepts/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Concepts</a>
  </li>
  <ul>
    <li class="collapse " id="docsconcepts">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsconceptslogic" href="/docs/concepts/logic/">The Logic of CUE</a>
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/concepts/packages/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Modules, Packages, and Instances</a>
  </li>
  <ul>
    <li class="collapse " id="docsconceptspackages">
      
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/tutorials/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Tutorials</a>
  </li>
  <ul>
    <li class="collapse " id="docstutorials">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docstutorialskubernetes" href="/docs/tutorials/kubernetes/"></a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/references/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">References</a>
  </li>
  <ul>
    <li class="collapse " id="docsreferences">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-docsreferencesspec" href="/docs/references/spec/">Language Specification</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            






<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">





<a href="https://github.com/cuelang/cuelang.org/edit/master/content/en/docs/usecases/generate.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/cuelang/cuelang.org/issues/new?title=Code%20Generation%20and%20Extraction" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>


<a href="https://github.com/cuelang/cue/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>

</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#core-issues-addressed-by-cue">Core issues addressed by CUE</a>
      <ul>
        <li><a href="#extract-data-definition-from-existing-sources">Extract data definition from existing sources</a></li>
        <li><a href="#enhance-existing-standards">Enhance existing standards</a></li>
        <li><a href="#convert-cue-to-other-standards">Convert CUE to other standards</a></li>
      </ul>
    </li>
    <li><a href="#comparisons">Comparisons</a>
      <ul>
        <li><a href="#cel">CEL</a></li>
        <li><a href="#protoc-gen-validate-pgv">Protoc-gen-validate (PGV)</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://cuelang.org/docs/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://cuelang.org/docs/usecases/">Use Cases</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://cuelang.org/docs/usecases/generate/">Code Generation and Extraction</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Code Generation and Extraction</h1>
	<div class="lead">Converting CUE constraints to and from definitions in other languages.</div>
	<p>Code generation and extraction is a broad topic and, for instance, overlaps
with the topics discussed in
<a href="/docs/usecases/datadef">Data Definition</a> and
<a href="/docs/integrations/go">Go</a>.</p>
<p>In this section we emphesize the role of CUE in a code-generation pipeline,
that is using CUE as an interlingua for the extraction from and the
generation to multiple sources.</p>
<h2 id="core-issues-addressed-by-cue">Core issues addressed by CUE</h2>
<h3 id="extract-data-definition-from-existing-sources">Extract data definition from existing sources</h3>
<p>When one identifies the need to define interchangeable data schema
one usually already has some code base to deal with.</p>
<p>CUE can currently extract definitions from:</p>
<ul>
<li><a href="/docs/integrations/go#extract-cue-from-go">Go code</a></li>
<li>Protobuf definitions.</li>
</ul>
<p>Moreover, CUE can combine and reduce the constraints from various sources
and report if there are any inconsistencies.</p>
<h3 id="enhance-existing-standards">Enhance existing standards</h3>
<p>CUE also allows annotating existing sources with CUE expressions.
This allows one to keep using existing sources or allow for a smoother
transition into taking a CUE-centric approach.
For instance, a project might be quite reliant on protobuf definitions
as the source of truth of at least one aspect of schema definition.
For this particular case, CUE allows annotating Protobuf field declarations
with CUE expressions using field options.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-proto" data-lang="proto"><span style="color:#204a87;font-weight:bold">message</span> <span style="color:#000">Server</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#a40000">
</span><span style="color:#a40000"></span>  <span style="color:#204a87;font-weight:bold">int32</span> <span style="color:#000">port</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">[(</span><span style="color:#000">cue.val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&gt;5000 &amp; &lt;10_000&#34;</span><span style="color:#000;font-weight:bold">];</span><span style="color:#a40000">
</span><span style="color:#a40000"></span><span style="color:#000;font-weight:bold">}</span></code></pre></div>
<p>A similar approach is supported for Go:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">Sum</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">A</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#4e9a06">`cue:&#34;c-b&#34; json:&#34;a,omitempty&#34;`</span>
    <span style="color:#000">B</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#4e9a06">`cue:&#34;c-a&#34; json:&#34;b,omitempty&#34;`</span>
    <span style="color:#000">C</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#4e9a06">`cue:&#34;a+b&#34; json:&#34;c,omitempty&#34;`</span>
<span style="color:#000;font-weight:bold">}</span></code></pre></div>
<p>In both cases, the constraints will be included the extraction to CUE.
In the case of Go, the constraints specified in the field tags can also
be used to validate Go structs directly.</p>
<h3 id="convert-cue-to-other-standards">Convert CUE to other standards</h3>
<p>Currently, CUE supports converting CUE to OpenAPI and Go, although it is
certainly not limited to these cases.</p>
<h2 id="comparisons">Comparisons</h2>
<h3 id="cel">CEL</h3>
<p>The <a href="https://github.com/google/cel-spec">Common Expression Language</a>,
or CEL, defines a simple expression language that can be used as a
standardization of constraints.
It focusses on simplicity, speed, termination guarantees and
being able run embedded in applications.</p>
<p>Unification of basic typed-feature strucutres has pseudo-linear run
time complexity.
The addition of comprehensions make the operation polynomial.
Not disallowing recursion would make CUE Turing complete.
The addition of sum types in CUE make certain operations NP-complete.
The NP-completeness manifests itself only when reasoning over incomplete types.
Trying to optimize a CEL expression would generally suffer from the same issue.
The same problem does not exist when applying CUE to concrete values.</p>
<p>That said, CUE is currently not optimized for embedded running.
Currently, generated Go stubs embed a CUE interpreter into the code.
These stubs are compatible with a mode where CUE generates native code,
which would give it similar characteristics.</p>
<p>CEL allows embedded implementation to add arbitrary functions.
CUE does not.
CUE keeps tight control over the pureness or hermeticity of evaluation
and to ensure the properties of the value lattice are not broken.
It would be possible, however, to provide the ability to add custom functions
for restricted to concrete values.</p>
<h3 id="protoc-gen-validate-pgv">Protoc-gen-validate (PGV)</h3>
<p>PGV also allows annotating Protobuf fields with validation code,
with implementations for Go and Java and an experimental versions for C++
as of this writing.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-proto" data-lang="proto"><span style="color:#204a87;font-weight:bold">message</span> <span style="color:#000">Server</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#a40000">
</span><span style="color:#a40000"></span>  <span style="color:#204a87;font-weight:bold">int32</span> <span style="color:#000">port</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">[(</span><span style="color:#000">validate.rules</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">int32</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">gte</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5000</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">lte</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10000</span> <span style="color:#000;font-weight:bold">}];</span><span style="color:#a40000">
</span><span style="color:#a40000"></span><span style="color:#000;font-weight:bold">}</span></code></pre></div>

	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified September 1, 2019: <a  href="https://github.com/cuelang/cuelang.org/commit/055be7e3e681d304424b9d58bdf73d4127dcfa98">Fix typo (on -&gt; one) (055be7e)</a>
</div>
</div>


          </main>
        </div>
      </div>
      

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code' ],
    ignoreClass: "mermaid",
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>


<link href="https://cuelang.org/mermaid/mermaid.css" rel="stylesheet" />
<script src="https://cuelang.org/mermaid/mermaid.js"></script>
<script>
    mermaid.initialize({
        startOnLoad: true,
        flowchart: {
            curve: 'basis'
        }
    });
</script>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>







<script src="/js/main.min.2187fca64cce5b93625c3b6ebbc286d5a6026eaa944cef7319ed98d12dd39c91.js" integrity="sha256-IYf8pkzOW5NiXDtuu8KG1aYCbqqUTO9zGe2Y0S3TnJE=" crossorigin="anonymous"></script>

<script src=https://cuelang.org/js/asciinema-player.js></script>

  </body>
</html>